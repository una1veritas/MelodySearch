\documentclass[11pt]{jarticle}
\input{A4}
\usepackage{graphics}
%\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{marvosym}

\usepackage{theorem}
\newtheorem{assumption}{Assumption}

\renewcommand{\baselinestretch}{1.15}
\setlength{\parskip}{0.5ex}
\renewcommand{\arraystretch}{0.8}

\newcommand{\napier}{%
%    \mathrm{e}    % 
\mathnormal{\mbox{\large{$\mathrm{e}$}}}    % 
}

\begin{document}

\section{分割統治法による多項式の評価}

$A(x)$ を $n-1$ 次の多項式 $A(x) = a_0 + a_1 x^1 + a_2 x^2 + \cdots + a_{n-1} x^{n-1}$,  
$\vec{a}$ を $A$ の係数列 $\vec{a} = (a_0, a_1, \ldots, a_{n-1})$ とする. 
ここで一般性を失うことなく $n$ は偶数であると仮定してよい； 
そうでないなら $n' = n + 1$ 次の  $A'$ ただし $a' = (a_0, a_1, \ldots, a_{n-1}, 0)$, つまり $n$ 次の係数は 0, を考える. 

すると, 
\begin{eqnarray*}
A(x) &=& a_0 + a_2 x^2 + \cdots + a_{n-2} x^{n-2}
+ a_1 x^1 + a_3 x^3 + \cdots +a_{n-1} x^{x-1} \\
&=& \sum_{i=0}^{n/2 - 1} a_{2i} x^{2i} + x \cdot\sum_{i=0}^{n/2 - 1} a_{2i+1} x^{2i} \,
\end{eqnarray*}
と書ける. 
ここで係数列 $(a_0, a_2, \ldots, a_{n-2})$ の多項式 $A_0$ と $(a_1, a_3, \ldots, a_{n-1})$ の $A_1$, 二つの多項式を導入すれば, 上の式は 
\begin{eqnarray*}
A(x) = A_0(x^2) + x \cdot A_1(x^2) \,
\end{eqnarray*}
と書き換えられる．
したがって，$x^2, x^4, x^6, \ldots, x^{n/2}$ と $x$ 倍の計算で，$n-1$ 次の多項式 $A(x)$ の値を求めることができる．

さらに, もし $n$ が 2 のべきであるなら, $x, x^2, x^4, \ldots, x^{\log_2{n}}$ について再帰的に評価をすることで時間計算量
\[
T(n) =
\left\{\begin{array}{ll}
2 & n \leq 1 \,,\\
2T(n/2) + 2 & \mbox{otherwise}\,,
\end{array}\right.
\]
つまり $O(\log_2{n})$ で計算ができる. 
これを
 $x = \napier^{-\boldsymbol\iota\frac{2\pi}{n}i}$ にもちいるのが高速フーリエ変換 FFT である. 
$\boldsymbol\iota$ は虚数単位. 
 
 
\section{多項式の評価による文字列パタン照合}

有限アルファベットを $\Sigma$とし, その大きさを $N=|\Sigma|$ とする. 
有限アルファベット $\Sigma$ 上の文字列 $t = t_0 \cdot t_1 \cdot \cdots\cdot t_{n-1}$, $p = p_0 \cdot \cdots \cdot p_{m-1}$ ただし $n \geq m$ を, それぞれテキスト, パタンと呼ぶこととする. 
有限アルファベットの要素 $a_1, \ldots, a_{N}$ は, 多項式に現れるときそれぞれを整数値 $1, \ldots, N$ とみなすことにする. 

ここで 
%$\omega^i = \napier^{-\boldsymbol\iota\frac{2\pi}{N}}$ をもちいて
テキストとパタンそれぞれの $x$ の多項式 $T, P$ を
\begin{eqnarray*}
T(i) = t_i \cdot x^{n-1-i}, \, P(i) = p_i \cdot w_p(i) \,,
\end{eqnarray*}
ただし
\begin{eqnarray*}
w_p(i) = \left\{\begin{array}{ll}
x^i & 0 \leq i < m \,,\\
0 & i \geq m
\end{array}\right.
\end{eqnarray*}
としよう. 
するとたとえばパタン $p = p_0 p_1 p_2$ がテキスト $t = t_0 t_1 t_2 t_3 t_4 \cdots t_{n-1}$ の位置 $2$ に出現する, すなわち $0 \leq i < m$ について $p_i = t_{2+i}$ であるかどうかは, 多項式
\begin{eqnarray*}
&& \sum_{i=0}^{n-1} T(i) \cdot P((i-2) \bmod n) \\
&=& t_2 \cdot x^{n-1-2} \cdot p_0 \cdot w_p(0) + t_3 \cdot x^{n-1-3} \cdot p_1 \cdot w_p(1) + t_4 \cdot x^{n-1-4} \cdot p_2 \cdot w_p(2)\\
&=& x^{n-3}\sum_{i=0}^{2}t_{i+2}\cdot p_{i}
\end{eqnarray*}
を評価することで知ることができる; 
ここで $P$ の添え字を $i \bmod n$ としているのは, ただ添え字を定義域の中に収めるためである. 
上式の値は, $t_{[2,4]}$ と $p$ をベクトル $\vec{t_{[2,4]}} = (t_2, t_3, t_4)$ と $\vec{p} = (p_0, p_1, p_2)$ の内積に $x^{n-3}$ を乗じたものに等しく, 
\[
\frac{\vec{t_{[2,4]}} \cdot \vec{p}}{|\vec{t_{[2,4]}}|\cdot |\vec{p}|} = 1
\]
であるとき, またそのときに限り $t_{[2,4]} = p$ であることを使うと, 上式が $x^{n-3} \cdot |\vec{t_{[2,4]}}|\cdot |\vec{p}|$ に等しいとき, 
位置 2 に出現しているとわかる. 

このテキストの部分列のノルム $|\vec{t_{[2,4]}}|$ が位置によって異なるのは, 計算量の点で都合がわるい. 
そこで, 文字 $a_i \in \Sigma$ を複素数 $a_i = \napier^{-\boldsymbol\iota\frac{2\pi}{N}i}$ で表すことにする.  
すると, ベクトルのノルムは含まれる文字によらず, 文字列長に等しくなる. 
すなわち, $t_{[j,j+m-1]} = p$ のとき, またそのときに限り 
\[
{t_{[j,j+m-1]}}^\dagger \cdot p = m
\]
となる. 
ただし$\dagger$ は複素共役なベクトル. 

以上から, 
\begin{eqnarray*}
M(i) = \sum_{k = 0}^{n-1} T(i+k) \cdot P(k) 
= x^{n-1-i} \sum_{k = 0}^{k < |p|}  t_{i+k} \cdot p_i 
\end{eqnarray*}
を $0 \leq i < n$ について求めれば, $M(i) = m$ のとき $i+1$ に $p$ が出現しているとわかる. 
この $M(0), \ldots, M(n-1)$ の計算は, 離散フーリエ変換, もしくは $n$ が 2 のべきのとき高速フーリエ変換で行う. 

\section{FFT による文字列パタン照合}

\begin{enumerate}
\item[入力:]有限アルファベット $\Sigma = \{a_0, a_{N-1}\}$ 上のテキスト $t \in \Sigma^*$ と パターン $p \in \Sigma^*$, ただし $|t| \leq |p|$. 
\item $n = 2^{\lceil{\log {|t|}}\rceil}$ とする. 
\item 文字 $a_i$ を $\omega^i = \napier^{\boldsymbol\iota\frac{2\pi}{N}i}$ で置き換えた長さ $n$ の列 $\vec{t}$ と複素共役な列 $t^\dagger$ と, $p$ の逆順の文字を $\omega^i$ で置き換えた長さ $n$ の列 $p^R$ を作る. 
文字列の長さが満たない部分の要素は $0$ でうめておく. 
\item $t^\dagger$ と $p^R$ それぞれを高速フーリエ変換した列 $T, P$ を求める.
\item $T$ と $P$ の要素ごとの積からなる列 $Q$ を求める. ($Q(i) = T(i)\cdot P(i)$)
\item $Q$ を逆高速フーリエ変換した列 $M$ を求める. 
\item $M(i) = |p|$ となる位置 $i$ を枚挙する. $i+1$ が出現位置である. 
\end{enumerate}
以上により, $p$ の長さにかかわらず $O(n \log n)$ 時間で終了する. 

\end{document}